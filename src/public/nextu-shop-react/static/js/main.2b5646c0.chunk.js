(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{32:function(e,t,a){e.exports=a(55)},37:function(e,t,a){},39:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},51:function(e,t,a){},52:function(e,t,a){},53:function(e,t,a){},54:function(e,t,a){},55:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(22),o=a.n(c),s=(a(37),a(38),a(9)),l=a(17),i=(a(39),a(28)),m=function(e){var t=e.component,a=Object(i.a)(e,["component"]);return r.a.createElement(l.b,Object.assign({},a,{render:function(e){return localStorage.getItem("rtoken")?r.a.createElement(t,e):r.a.createElement(l.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},u=a(2),d=a(3),p=a(5),h=a(4),E=a(7),f=a(6),v=a(18),b=a.n(v),g=(a(48),""),N="/api/v1",O=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).state={user:"",pass:"",error:""},a.handleUser=a.handleUser.bind(Object(E.a)(a)),a.handlePass=a.handlePass.bind(Object(E.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(E.a)(a)),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){localStorage.clear(),b.a.AutoInit()}},{key:"handleUser",value:function(e){var t=e.target.value;this.setState({user:t,error:""})}},{key:"handlePass",value:function(e){var t=e.target.value;this.setState({pass:t,error:""})}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a="";if(""==this.state.user?a="El usuario es obligatorio":""==this.state.pass&&(a="La contrase\xf1a es obligatoria"),""!=a)return this.setState({error:a}),!1;var n={user:this.state.user,pass:this.state.pass};fetch("".concat(N,"/login"),{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){console.warn("data",e),e.ok?(localStorage.setItem("rtoken",t.state.user),t.props.history.push("/")):t.setState({error:e.message})}).catch(function(e){return console.error("error",e)})}},{key:"render",value:function(){var e={backgroundImage:"url('".concat(g,"/login-fondo.jpg')")};return r.a.createElement("main",{className:"login-container",style:e},r.a.createElement("center",null,r.a.createElement("div",{className:"section"}),r.a.createElement("div",{className:"section"}),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"z-depth-1 grey lighten-4 row sub-container"},r.a.createElement("h5",{className:"indigo-text"},"Inicia Sesi\xf3n"),r.a.createElement("form",{className:"col s12",onSubmit:this.handleSubmit},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12"})),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("label",null,"Enter your email"),r.a.createElement("input",{className:"validate",type:"email",value:this.state.user||"",onChange:this.handleUser}))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{className:"validate",type:"password",value:this.state.pass||"",onChange:this.handlePass}),r.a.createElement("label",null,"Enter your password"))),r.a.createElement("div",{className:"row"},this.state.error&&r.a.createElement("label",{className:"error-text"},this.state.error)),r.a.createElement("br",null),r.a.createElement("center",null,r.a.createElement("div",{className:"row"},r.a.createElement("button",{type:"submit",name:"btn_login",className:"col s12 btn btn-large waves-effect indigo"},"Login"))))))))}}]),t}(n.Component),j=a(8),y=(a(49),function(e){function t(e){var a;return Object(u.a)(this,t),a=Object(p.a)(this,Object(h.a)(t).call(this,e)),console.log(e.unidades),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("nav",null,r.a.createElement("div",{className:"nav-wrapper"},r.a.createElement("span",{className:"brand-logo color-fuente"},"OnlineShop"),r.a.createElement("ul",{id:"nav-mobile",className:"right hide-on-med-and-down"},r.a.createElement("li",{className:"menu-item-route"},r.a.createElement(s.b,{to:"/"},r.a.createElement("i",{className:"material-icons"},"apps"))),r.a.createElement("li",{className:"menu-item-route"},r.a.createElement(s.b,{to:"/carrito"},r.a.createElement("i",{className:"material-icons"},"shopping_cart")),r.a.createElement("span",{className:"badge note-badge"},this.props.unidades)),r.a.createElement("li",{className:"menu-item-route"},r.a.createElement(s.b,{to:"/login"},r.a.createElement("i",{className:"material-icons"},"exit_to_app")))))))}}]),t}(n.Component)),w=a(15),C=(a(51),Object(w.b)(function(e){return{carrito:e.productos.carrito}},null)(function(e){var t=e.body,a=e.carrito,n={backgroundImage:"url('".concat(g,"/main-fondo.jpg')")};return r.a.createElement("div",{className:"app-frame-content",style:n},r.a.createElement(y,{unidades:a.length}),r.a.createElement("br",null),r.a.createElement("div",{className:"container container-backg"},t))})),S=(a(52),a(53),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).state={units:a.props.units,cantidad:1},a.handleChange=a.handleChange.bind(Object(E.a)(a)),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"addToCarrito",value:function(e){this.props.setCarrito(e);var t=this.state.units-Number(e.cantidad);this.setState({cantidad:1,units:t})}},{key:"handleChange",value:function(e){var t=Number(e.target.value);this.setState({cantidad:t})}},{key:"render",value:function(){var e=this.props.id;return r.a.createElement("div",{className:"col s4 m3"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-image"},r.a.createElement("img",{src:this.props.img,alt:this.props.name,className:"img-producto"}),r.a.createElement("span",{className:"card-title"},this.props.name)),r.a.createElement("div",{className:"card-content"},r.a.createElement("p",null,"Precio: ",this.props.price),r.a.createElement("p",null,"Unidades: ",this.state.units)),r.a.createElement("div",{className:"card-action"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s6 m6"},r.a.createElement(s.b,{className:"btn waves-effect waves-light btn-small",to:"/detalle/".concat(e)},"Ver m\xe1s")),r.a.createElement("div",{className:"col s3 m3"},r.a.createElement("button",{className:"btn waves-effect waves-light btn-small btn-amarillo",type:"button",onClick:this.addToCarrito.bind(this,{id:e,cantidad:this.state.cantidad})},r.a.createElement("i",{className:"material-icons"},"add"))),r.a.createElement("div",{className:"col s3 m3"},r.a.createElement("input",{type:"number",min:"1",value:this.state.cantidad,max:this.props.units,className:"validate",onChange:this.handleChange}))))))}}]),t}(n.Component)),k=function(){var e="".concat(N,"/productos");return fetch(e).then(function(e){return e.json()}).then(function(e){return e.map(function(e){return Object(j.a)({},e,{img:"".concat(g,"/img/").concat(e.img)})})})},_=function(e){var t={productos:e};console.log(t);var a={method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}};return fetch("".concat(N,"/productos"),a).then(function(e){return e.json()}).then(function(e){return e}).catch(console.log)},P=function(e){return{type:"SET_PRODUCTS",payload:{productos:e}}},T=function(e){function t(){var e;return Object(u.a)(this,t),(e=Object(p.a)(this,Object(h.a)(t).call(this))).getProductos=function(){e.setState({loading:!0}),k().then(function(t){console.log("recibido",t),t&&(e.setState({loading:!1,lista:t}),e.props._setearProductos(t))}).catch(function(e){return console.warn(e)})},e.loader=function(){return e.state.loading&&r.a.createElement("div",{className:"progress"},r.a.createElement("div",{className:"indeterminate"}))},e.filtrar=function(t){if(""==t.target.value)e.setState({lista:e.props.productos});else{var a=e.props.productos.filter(function(e){return e.name.toLowerCase().indexOf(t.target.value.toLowerCase())>=0});e.setState({lista:a})}},e.verValor=function(t){var a=e.props.productos.find(function(e){return e.id==t.id});0==e.props.carrito.filter(function(e){return e.id==t.id}).length?e.props._setCarrito(Object(j.a)({},a,{cantidad:t.cantidad})):e.props._replaceCarrito(Object(j.a)({},a,{cantidad:t.cantidad}))},e.state={filtro:"",loading:!1,lista:[]},e.filtrar=e.filtrar.bind(Object(E.a)(e)),e}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){b.a.AutoInit(),this.getProductos()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(C,{body:r.a.createElement("div",{className:"content-body-home"},r.a.createElement("nav",null,r.a.createElement("div",{className:"nav-wrapper"},r.a.createElement("span",{className:"left brand-logo color-fuente"},"Cat\xe1logo de productos"),r.a.createElement("form",{className:"right hide-on-med-and-down"},r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{id:"search",type:"search",onChange:this.filtrar}),r.a.createElement("label",{className:"label-icon"},r.a.createElement("i",{className:"material-icons"},"search")))))),this.loader(),r.a.createElement("div",{className:"row"},this.state.lista.map(function(t){return r.a.createElement(S,Object.assign({key:t.id},t,{setCarrito:e.verValor}))})))}))}}]),t}(n.Component),R=Object(w.b)(function(e){return{productos:e.productos.productos,carrito:e.productos.carrito}},function(e){return{_setearProductos:function(t){return e(P(t))},_setCarrito:function(t){return e({type:"SET_CARRITO",payload:{producto:t}})},_replaceCarrito:function(t){return e({type:"REPLACE_CARRITO",payload:{carrito:t}})}}})(T),I=(a(54),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).goBack=function(){a.props.history.goBack()},a.pagarCarrito=function(){a.state.carrito.length<=0||_(a.state.carrito).then(function(e){e.ok?(alert("Se realizo el pago correctamente"),a.props._clearCarrito(),a.props.history.goBack()):alert("No se pudo realizar el pago")}).catch(function(e){console.log(e)})},a.state={carrito:a.props.carrito},a.pagarCarrito=a.pagarCarrito.bind(Object(E.a)(a)),console.log(a.state),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"sumaProductos",value:function(){return this.state.carrito.reduce(function(e,t){return e+t.cantidad*t.price},0)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(C,{body:r.a.createElement("div",{className:"content-body-home"},r.a.createElement("nav",null,r.a.createElement("div",{className:"nav-wrapper"},r.a.createElement("span",{className:"left brand-logo color-fuente"},"Carrito de compras"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12 m6"},r.a.createElement("ul",{className:"collection"},this.state.carrito.map(function(e){return r.a.createElement("li",{key:e.id,className:"collection-item avatar"},r.a.createElement("img",{src:e.img,alt:"",className:"circle"}),r.a.createElement("span",{className:"title"},e.name),r.a.createElement("p",null,"Unidades: ",e.cantidad," ",r.a.createElement("br",null),r.a.createElement("strong",null,"Subtotal:")," ",e.cantidad*e.price),r.a.createElement("a",{href:"#!",className:"secondary-content"},r.a.createElement("i",{className:"material-icons"},"grade")))}))),r.a.createElement("div",{className:"col s12 m6"},r.a.createElement("h3",null,"Total: ",this.sumaProductos()),r.a.createElement("br",null),r.a.createElement("button",{className:"waves-effect waves-light btn",onClick:this.goBack},"Cancelar"),r.a.createElement("button",{className:"waves-effect waves-light btn",onClick:this.pagarCarrito},"Pagar"))))}))}}]),t}(n.Component)),A=Object(w.b)(function(e){return{carrito:e.productos.carrito}},function(e){return{_setearProductos:function(t){return e(P(t))},_clearCarrito:function(t){return e({type:"CLEAR_CARRITO",payload:{}})}}})(I),D=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(p.a)(this,Object(h.a)(t).call(this,e))).getProducto=function(e){a.setState({loading:!0}),fetch("".concat(N,"/productos/").concat(e)).then(function(e){return e.json()}).then(function(e){var t=Object(j.a)({},e,{img:"".concat(g,"/img/").concat(e.img)});a.setState({producto:t,loading:!1}),console.log(a.state)}).catch(function(e){a.setState({loading:!1}),console.log("err",e),a.setState({producto:{}})})},a.loading=function(){return a.state.loading&&r.a.createElement("div",{className:"progress"},r.a.createElement("div",{className:"indeterminate"}))},console.log("props",e),a.state={producto:{},loading:!1},a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){b.a.AutoInit(),this.getProducto(this.props.match.params.id)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(C,{body:r.a.createElement("div",{className:"content-body-home"},r.a.createElement("nav",null,r.a.createElement("div",{className:"nav-wrapper"},r.a.createElement("span",{className:"left brand-logo color-fuente"},"Detalle Producto"))),this.loading(),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s1 m1"}),r.a.createElement("div",{className:"col s10 m10"},r.a.createElement("h2",{className:"header"},this.state.producto.name),r.a.createElement("div",{className:"card horizontal"},r.a.createElement("div",{className:"card-image"},r.a.createElement("img",{src:this.state.producto.img})),r.a.createElement("div",{className:"card-stacked"},r.a.createElement("div",{className:"card-content"},r.a.createElement("p",null,"Precio: ",this.state.producto.price),r.a.createElement("p",null,"Unidades: ",this.state.producto.units)),r.a.createElement("div",{className:"card-action"},r.a.createElement(s.b,{className:"btn waves-effect waves-light",to:"/"},"Atr\xe1s"))))),r.a.createElement("div",{className:"col s1 m1"})))}))}}]),t}(n.Component);var U=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(s.a,{basename:"/react"},r.a.createElement(l.b,{path:"/login",component:O}),r.a.createElement(m,{exact:!0,path:"/",component:R}),r.a.createElement(m,{path:"/carrito",component:A}),r.a.createElement(m,{path:"/detalle/:id",component:D})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var L=a(19),x=a(31),B={productos:[],carrito:[]},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_PRODUCTS":return Object(j.a)({},e,{productos:Array.from(t.payload.productos)});case"SET_CARRITO":return Object(j.a)({},e,{carrito:[].concat(Object(x.a)(e.carrito),[t.payload.producto])});case"CLEAR_CARRITO":return Object(j.a)({},e,{carrito:[]});case"REPLACE_CARRITO":var a=e.carrito.map(function(e){return e.id==t.payload.carrito.id?t.payload.carrito:e});return Object(j.a)({},e,{carrito:a});default:return e}},z=Object(L.b)({productos:V}),J=Object(L.c)(z,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());J.subscribe(function(){console.log("store modificado ",J.getState())});var X=J;o.a.render(r.a.createElement(w.a,{store:X},r.a.createElement(U,null)),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.2b5646c0.chunk.js.map